# ComtecDr

コムテックのドライブレコーダーの動画からGPSログデータを取り出すためのプログラムです。
[コムテックのHDR-352GH](http://www.e-comtec.co.jp/0_recorder/hdr352gh.html)で動作確認していますが、他の型番でも動作するかもしれません。

## Installation

Add this line to your application's Gemfile:

```ruby
gem 'comtec-dr'
```

And then execute:

    $ bundle

Or install it yourself as:

    $ gem install comtec-dr

## Usage


### CSVデータで取り出し

movファイルもしくはディレクトリを引数に取ることが出来ます

```
comtec_mov_to_csv /Volumes/NO\ NAME/DCIM/20171005_003/007_130755_G.MOV
comtec_mov_to_csv /Volumes/NO\ NAME/DCIM/20171005_003
```

CSVファイルの列には以下の情報が含まれています。
緯度, 経度, 速度(km/h), 時刻, ミリ秒, X軸加速度, Y軸加速度, Z軸加速度, ファイル名

```
35.673485,         136.95376166666668, 67, 2017-10-04 10:48:54 +0900, 29160, 0.175, 0.052, 0.003,  000_104824_A.MOV
35.673485,         136.95376166666668, 67, 2017-10-04 10:48:54 +0900, 29260, 0.184, 0.091, -0.009, 000_104824_A.MOV
35.67357166666667, 136.95374833333332, 70, 2017-10-04 10:48:54 +0900, 29360, 0.188, 0.034, 0.021,  000_104824_A.MOV
35.67357166666667, 136.95374833333332, 70, 2017-10-04 10:48:54 +0900, 29460, 0.184, 0.046, 0.047,  000_104824_A.MOV
35.67357166666667, 136.95374833333332, 70, 2017-10-04 10:48:54 +0900, 29560, 0.146, 0.084, 0.005,  000_104824_A.MOV
35.67357166666667, 136.95374833333332, 70, 2017-10-04 10:48:54 +0900, 29660, 0.164, 0.06,  0.001,  000_104824_A.MOV
35.67357166666667, 136.95374833333332, 70, 2017-10-04 10:48:54 +0900, 29760, 0.17,  0.073, -0.029, 000_104824_A.MOV
35.67366333333333, 136.953735,         72, 2017-10-04 10:48:54 +0900, 29860, 0.187, 0.069, 0.006,  000_104824_A.MOV
35.67366333333333, 136.953735,         72, 2017-10-04 10:48:54 +0900, 29960, 0.154, 0.089, 0.048,  000_104824_A.MOV
35.67366333333333, 136.953735,         72, 2017-10-04 10:48:54 +0900, 30060, 0.186, 0.064, -0.006, 000_104824_A.MOV
35.67366333333333, 136.953735,         72, 2017-10-04 10:48:55 +0900, 30160, 0.16,  0.031, 0.006,  000_104824_A.MOV
35.67366333333333, 136.953735,         72, 2017-10-04 10:48:55 +0900, 30260, 0.157, 0.036, 0.005,  000_104824_A.MOV
35.67375666666667, 136.95372166666667, 75, 2017-10-04 10:48:55 +0900, 30360, 0.186, 0.043, 0.056,  000_104824_A.MOV
35.67375666666667, 136.95372166666667, 75, 2017-10-04 10:48:55 +0900, 30460, 0.151, 0.067, 0.034,  000_104824_A.MOV
35.67375666666667, 136.95372166666667, 75, 2017-10-04 10:48:55 +0900, 30560, 0.122, 0.034, -0.015, 000_104824_A.MOV
35.67375666666667, 136.95372166666667, 75, 2017-10-04 10:48:55 +0900, 30660, 0.224, 0.046, 0.002,  000_104824_A.MOV
35.67375666666667, 136.95372166666667, 75, 2017-10-04 10:48:55 +0900, 30760, 0.135, 0.081, -0.008, 000_104824_A.MOV
35.673855,         136.95370833333334, 78, 2017-10-04 10:48:55 +0900, 30860, 0.142, 0.042, -0.008, 000_104824_A.MOV
35.673855,         136.95370833333334, 78, 2017-10-04 10:48:55 +0900, 30960, 0.168, 0.033, 0.007,  000_104824_A.MOV
35.673855,         136.95370833333334, 78, 2017-10-04 10:48:55 +0900, 31060, 0.134, 0.073, -0.003, 000_104824_A.MOV
```

上記の例は2秒間のログを抜粋したもので、
緯度,経度,速度は秒間2回、加速度は秒間10回センシングされているようです。

### GPXデータで取り出し

movファイルもしくはディレクトリを引数に取ることが出来ます

```
comtec_mov_to_gpx /Volumes/NO\ NAME/DCIM/20171005_003/007_130755_G.MOV
comtec_mov_to_gpx /Volumes/NO\ NAME/DCIM/20171005_003
```

GPXデータ生成時には重複した位置情報は取り除きます。
